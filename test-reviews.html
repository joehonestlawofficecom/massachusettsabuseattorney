<div class="sqs-layout sqs-grid-12 columns-12 hl-testimonial-layout"><div class="row sqs-row"><div class="col sqs-col-12 span-12">
  <div class="sqs-block horizontalrule-block sqs-block-horizontalrule" data-block-type="47" id="block-hl-prefooter-hr"><div class="sqs-block-content"><hr></div></div>
  <div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-hl-testimonial"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <style>
    .hl-testimonial-layout{
      margin-top: -24px !important;
      padding-top: 0 !important;
    }
    .hl-testimonial-layout .sqs-row{
      margin-top: 0 !important;
    }
    #block-hl-prefooter-hr{
      margin-top: 0 !important;
      padding-top: 0 !important;
      padding-bottom: 0 !important;
    }
    #block-hl-prefooter-hr .sqs-block-content{
      padding-top: 0 !important;
      padding-bottom: 0 !important;
      margin-top: 0 !important;
      margin-bottom: 0 !important;
    }
    #block-hl-prefooter-hr hr{
      margin-top: 3px !important;
      margin-bottom: 0 !important;
    }
    .hl-testimonial-shell{
      --hl-review-bg: #ffffff;
      --hl-review-quote-color: #222222;
      --hl-review-source-color: #6f6f6f;
      --hl-review-accent-quote: #d9d9d9;
      --hl-review-max-width: 720px;
      background: var(--hl-review-bg);
      font-family: Georgia, "Times New Roman", serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .hl-testimonial{
      max-width: var(--hl-review-max-width);
      padding: 32px 48px;
      margin: 0 auto;
      text-align: center;
      color: var(--hl-review-quote-color);
    }

    .hl-quote-mark{
      font-size: 72px;
      color: var(--hl-review-accent-quote);
      line-height: 0.6;
      margin-bottom: 18px;
      letter-spacing: 2px;
      display: block;
    }

    .hl-quote-stars,
    .hl-quote-text,
    .hl-quote-source{
      opacity: 1;
      transition: opacity 0.6s ease;
    }

    .hl-fade-out{
      opacity: 0;
    }

    .hl-quote-stars{
      font-size: 28px;
      line-height: 1;
      margin: 0 auto 16px;
      display: block;
      letter-spacing: 2px;
    }

    .hl-quote-text{
      font-size: 22px;
      line-height: 1.75;
      margin: 0 auto 28px;
      max-width: 64ch;
      font-style: italic;
    }

    .hl-quote-source{
      font-size: 22px;
      line-height: 1.75;
      color: var(--hl-review-source-color);
    }

    .hl-quote-source::before{
      content: "— ";
    }

    .hl-loading,
    .hl-error{
      font-size: 15px;
      color: var(--hl-review-source-color);
    }

    @media (max-width:520px){
      .hl-testimonial { padding: 24px 20px; }
      .hl-quote-mark { font-size: 56px; }
      .hl-quote-text,
      .hl-quote-source {
        font-size: 18px;
        line-height: 1.6;
      }
    }
  </style>

  <div class="hl-testimonial-shell">
    <div class="hl-testimonial">
      <div id="hl_review_status" class="hl-loading">Loading review...</div>
      <div id="hl_review_quote_mark" class="hl-quote-mark" style="display:none;">“</div>
      <div id="hl_review_stars" class="hl-quote-stars" style="display:none;">⭐⭐⭐⭐⭐</div>
      <div id="hl_review_quote" class="hl-quote-text" style="display:none;"></div>
      <div id="hl_review_source" class="hl-quote-source" style="display:none;"></div>
    </div>
  </div>

  <script>
    (function(){
      const spreadsheetId = "12Kr7faOpqZeDDVhnijzpm8AJYJdmR8NxxuUfVbKgnlU";
      const sheetName = "Sheet1";
      const url = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

      let reviews = [];
      let currentIndex = 0;
      const intervalTime = 10000;

      const statusEl = document.getElementById("hl_review_status");
      const quoteMarkEl = document.getElementById("hl_review_quote_mark");
      const starsEl = document.getElementById("hl_review_stars");
      const quoteEl = document.getElementById("hl_review_quote");
      const sourceEl = document.getElementById("hl_review_source");

      if (!statusEl || !quoteMarkEl || !starsEl || !quoteEl || !sourceEl) return;

      function showStatus(message, isError = false) {
        statusEl.textContent = message;
        statusEl.className = isError ? "hl-error" : "hl-loading";
        statusEl.style.display = "block";
      }

      function hideStatus() {
        statusEl.style.display = "none";
      }

      function updateDisplay(name, review) {
        quoteEl.textContent = review;
        sourceEl.textContent = name;
      }

      function fadeToNextReview() {
        starsEl.classList.add("hl-fade-out");
        quoteEl.classList.add("hl-fade-out");
        sourceEl.classList.add("hl-fade-out");

        setTimeout(() => {
          currentIndex = (currentIndex + 1) % reviews.length;
          const next = reviews[currentIndex];
          updateDisplay(next.name, next.review);

          starsEl.classList.remove("hl-fade-out");
          quoteEl.classList.remove("hl-fade-out");
          sourceEl.classList.remove("hl-fade-out");
        }, 600);
      }

      fetch(url)
        .then(res => res.text())
        .then(text => {
          const json = JSON.parse(
            text.substring(
              text.indexOf("{"),
              text.lastIndexOf("}") + 1
            )
          );

          const rows = json.table.rows.slice(1);
          reviews = rows.map(r => ({
            name: r.c[0]?.v || "",
            review: r.c[1]?.v || ""
          }));

          if (!reviews.length) {
            showStatus("No reviews found", true);
            return;
          }

          hideStatus();
          quoteMarkEl.style.display = "block";
          starsEl.style.display = "block";
          quoteEl.style.display = "block";
          sourceEl.style.display = "block";

          currentIndex = Math.floor(Math.random() * reviews.length);
          updateDisplay(reviews[currentIndex].name, reviews[currentIndex].review);
          setInterval(fadeToNextReview, intervalTime);
        })
        .catch(err => {
          console.error(err);
          showStatus("Unable to load reviews", true);
        });
    })();
  </script>
</div>


</div></div>
  </div></div></div>
